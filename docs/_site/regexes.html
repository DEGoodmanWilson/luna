<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Luna</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-light.css">
    <meta name="viewport" content="width=device-width">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <a href="index.html"><img src="img/luna.png" alt="luna" /></a>
        <p class="view"><a href="https://github.com/DEGoodmanWilson/luna">View the Project on GitHub <small>DEGoodmanWilson/luna</small></a></p>
        <h1>An embedded HTTP server in C++14</h1>

        <h2>Getting Started</h2>
        <ul>
          <li><a href="using.html">Using in your project</a></li>
        </ul>
        <h2>Using Luna</h2>
        <ul>
          <li><a href="configuration.html">Configuration options</a></li>
          <li><a href="simple_api_endpoint.html">Simple API endpoints</a></li>
          <li><a href="regexes.html">Endpoints using regexes</a></li>
          <li>HTTPS</li>
        </ul>
        <h2>Changelog</h2>
        <ul>
          <li><a href="1.0.0.html">1.0.x</a></li>
          <li><a href="1.0.0-beta.html">1.0.0-beta</a></li>
        </ul>
      </header>
      <section>
      <h1 id="defining-endpoints-with-regexes">Defining endpoints with regexes</h1>

<p>Sometimes you want to use a regex to capture a range of endpoints in one go. For example: You have a document server, and you want to serve documents using an endpoint like <code class="highlighter-rouge">/documents/[document id]</code>, where a document id is an <code class="highlighter-rouge">i</code> followed by 6 hexidecimal digits. You could set up such an endpoint like this:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>server server{server::mime_type{"text/json"}, server::port{8443}};

server.handle_response(request_method::GET,
    "^/documents/(i[0-9a-f]{6})", 
    [](auto matches, auto params) -&gt; response
    {
        // TODO...
    });
</code></pre>
</div>

<p>This endpoint will only be invoked if the requested URL matches the regex provided; and the matches are passed on to you. The first match in the vector will be the entire path, not especially useful in this case. Because we defined a match group in the regex around the document id, the second match will contain the document id itself.</p>

<p>Let us suppose that in our filesystem, we have a flat folder full of documents named <code class="highlighter-rouge">[document id].txt</code>. We could return the text documents as such:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="err">auto</span><span class="w"> </span><span class="err">doc_id</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">matches[1];</span><span class="w">
    </span><span class="err">//</span><span class="w"> </span><span class="err">load</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">file</span><span class="w"> </span><span class="err">named</span><span class="w"> </span><span class="err">doc_id+.</span><span class="nt">"txt"</span><span class="w"> </span><span class="err">into</span><span class="w"> </span><span class="err">a</span><span class="w"> </span><span class="err">std</span><span class="p">:</span><span class="err">:string</span><span class="w"> </span><span class="err">called</span><span class="w"> </span><span class="err">contents</span><span class="w">

    </span><span class="err">return</span><span class="w"> </span><span class="p">{</span><span class="nt">"text/plain"</span><span class="err">,</span><span class="w"> </span><span class="err">contents};</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/DEGoodmanWilson">DEGoodmanWilson</a></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>

  </body>
  </html>
